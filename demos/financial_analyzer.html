<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI Financial Document Analyzer - Automated Analysis & Risk Assessment">
    <title>Financial Document Analyzer - Dakota AI Demo</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href="../DA.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .financial-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .financial-header {
            text-align: center;
            margin-bottom: 3rem;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 3rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .roi-banner {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1f2937;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .upload-zone {
            background: white;
            padding: 3rem;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px dashed #d1d5db;
            text-align: center;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .upload-zone:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .upload-icon {
            font-size: 4rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .processing-status {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 24px;
            background: #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 12px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .analysis-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-top: 4px solid #3b82f6;
        }

        .metric-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3b82f6;
        }

        .risk-level {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .risk-high { background: #fee2e2; color: #dc2626; }
        .risk-medium { background: #fef3c7; color: #d97706; }
        .risk-low { background: #d1fae5; color: #059669; }

        .summary-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .btn-primary, .btn-secondary {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f4f6;
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: #fee2e2;
            border: 1px solid #fca5a5;
            color: #dc2626;
            padding: 1rem;
            border-radius: 8px;
            display: none;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }
        }

        /* Power BI-style Dashboard Components */
        .executive-summary {
            max-width: none;
        }

        .summary-header h4 {
            margin-bottom: 1.5rem;
            color: #1e293b;
            font-size: 1.4rem;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 0.5rem;
        }

        .company-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .metric-badge {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            text-align: center;
        }

        .metric-value {
            display: block;
            font-size: 1.8rem;
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            font-size: 0.9rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .positive-growth {
            color: #10b981 !important;
        }

        .insights-section, .quarterly-performance, .expense-breakdown, .strategic-recommendations, .industry-comparison, .financial-health {
            margin: 2.5rem 0;
            padding: 1.5rem;
            background: #f8fafc;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .insights-section h5, .quarterly-performance h5, .expense-breakdown h5, .strategic-recommendations h5, .industry-comparison h5, .financial-health h5 {
            color: #1e293b;
            margin-bottom: 1rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .insights-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .insights-list li {
            margin-bottom: 0.75rem;
            padding: 0.5rem;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .insights-list i {
            color: #10b981;
            font-size: 0.9rem;
            margin-top: 0.1rem;
        }

        .quarterly-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .quarter-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .quarter-card h6 {
            margin: 0 0 1rem 0;
            color: #3b82f6;
            font-size: 1rem;
            text-align: center;
            font-weight: 600;
        }

        .quarter-metrics {
            display: grid;
            gap: 0.5rem;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
        }

        .metric .label {
            font-weight: 600;
            color: #64748b;
            font-size: 0.9rem;
        }

        .metric .value {
            font-weight: bold;
            color: #1e293b;
        }

        .metric .value.positive {
            color: #10b981;
        }

        .expense-bars {
            display: grid;
            gap: 1rem;
        }

        .expense-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .expense-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #374151;
        }

        .expense-label .percentage {
            color: #3b82f6;
            font-size: 0.9rem;
        }

        .expense-bar {
            height: 20px;
            background: #f1f5f9;
            border-radius: 10px;
            overflow: hidden;
        }

        .expense-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            border-radius: 10px;
            transition: width 1s ease;
        }

        .recommendations-grid {
            display: grid;
            gap: 0.75rem;
        }

        .recommendation-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .recommendation-card:hover {
            transform: translateX(4px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .recommendation-card i {
            color: #10b981;
        }

        .industry-metrics {
            display: grid;
            gap: 1rem;
        }

        .industry-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .industry-label {
            font-weight: 600;
            color: #374151;
        }

        .industry-value {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.25rem;
        }

        .company-value {
            font-weight: bold;
            color: #3b82f6;
            font-size: 1.1rem;
        }

        .vs-industry {
            font-size: 0.8rem;
            color: #64748b;
        }

        .health-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .health-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .health-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #374151;
        }

        .health-label i {
            color: #3b82f6;
        }

        .health-value {
            font-weight: bold;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .health-value.success {
            background: #d1fae5;
            color: #065f46;
        }

        .health-value.warning {
            background: #fef3c7;
            color: #92400e;
        }

        .health-value.danger {
            background: #fee2e2;
            color: #dc2626;
        }

        /* Loading animation improvements */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }

        .metric-badge .metric-value.loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .sample-document-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .document-display {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        .document-header {
            background: #1e40af;
            color: white;
            padding: 1rem 1.5rem;
        }

        .document-header h4 {
            margin: 0 0 0.25rem 0;
            font-size: 1.1rem;
        }

        .document-meta {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .document-content {
            padding: 1.5rem;
        }

        .financial-content {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.4;
            color: #374151;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <main class="financial-container">
        <!-- Header Section -->
        <div class="financial-header">
            <h1><i class="fas fa-chart-line"></i> AI Financial Document Analyzer</h1>
            <p>Transform hours of manual document review into minutes of AI-powered analysis</p>
            <div class="roi-banner">
                ðŸš€ <strong>$2.5M Annual Savings</strong> - Automate financial document analysis and risk assessment
            </div>
        </div>

        <!-- Sample Document Analysis -->
        <div class="sample-document-section">
            <h3><i class="fas fa-file-pdf"></i> Sample Annual Report Analysis</h3>
            <div class="document-display">
                <div class="document-header">
                    <h4><i class="fas fa-building"></i> TechCorp Inc. - Annual Report 2024</h4>
                    <span class="document-meta">Filed: March 15, 2024 | Pages: 127 | Industry: Technology Solutions</span>
                </div>
                <div class="document-content">
                    <div class="financial-content">
                        <strong>COMPANY OVERVIEW:</strong><br>
                        TechCorp Inc. is a leading provider of enterprise software solutions, specializing in AI-powered analytics and cloud-based business intelligence platforms. Headquartered in Austin, Texas, with operations in 12 countries, the company services over 2,500 enterprise clients worldwide.<br><br>

                        <strong>FINANCIAL HIGHLIGHTS - YEAR ENDING DECEMBER 31, 2024:</strong><br>
                        â€¢ Annual Revenue: $175.2 million (up 12.5% from 2023)<br>
                        â€¢ Net Profit: $34.7 million<br>
                        â€¢ Total Assets: $487.3 million<br>
                        â€¢ Cash and Equivalents: $89.5 million<br>
                        â€¢ Debt-to-Equity Ratio: 1.25<br>
                        â€¢ Return on Assets: 7.1%<br><br>

                        <strong>KEY BUSINESS SEGMENTS:</strong><br>
                        â€¢ Analytics & BI Platforms: 45% of revenue, 68% profit contribution<br>
                        â€¢ AI Solutions & Services: 35% of revenue, 22% profit contribution<br>
                        â€¢ Cloud Services: 20% of revenue, 10% profit contribution<br><br>

                        <strong>OPERATING EXPENSES ($ millions):</strong><br>
                        â€¢ Cost of Goods Sold: $82.4 (47.0% of revenue)<br>
                        â€¢ Research & Development: $35.2 (20.1% of revenue)<br>
                        â€¢ Sales & Marketing: $22.1 (12.6% of revenue)<br>
                        â€¢ General & Administrative: $18.7 (10.7% of revenue)<br>
                        â€¢ Operating Income: $16.8 million<br><br>

                        <strong>OUTLOOK AND RISKS:</strong><br>
                        The company anticipates continued strong growth driven by increasing demand for AI-powered business solutions. Key risks include intense market competition, regulatory changes in data privacy laws, and potential economic slowdowns affecting enterprise technology spending. The company maintains conservative financial policies and strong liquidity position ($89.5M cash) to navigate market uncertainties.
                    </div>
                </div>
            </div>
        </div>

        <!-- Processing Status -->
        <div class="processing-status" id="processingStatus">
            <h3><i class="fas fa-cogs"></i> Analyzing Documents...</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <p id="progressText">Initializing AI analysis...</p>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage">
            <i class="fas fa-exclamation-triangle"></i>
            <span id="errorText"></span>
        </div>

        <!-- Analysis Results -->
        <div class="analysis-grid" id="analysisResults" style="display: none;">
            <!-- Key Metrics -->
            <div class="analysis-card">
                <h3><i class="fas fa-chart-pie"></i> Key Financial Metrics</h3>
                <div class="metric-display">
                    <span><i class="fas fa-dollar-sign"></i> Revenue</span>
                    <span class="metric-value" id="revenueValue">$0</span>
                </div>
                <div class="metric-display">
                    <span><i class="fas fa-chart-line"></i> Profit Margin</span>
                    <span class="metric-value" id="profitMargin">0%</span>
                </div>
                <div class="metric-display">
                    <span><i class="fas fa-balance-scale"></i> Debt Ratio</span>
                    <span class="metric-value" id="debtRatio">0%</span>
                </div>
            </div>

            <!-- Risk Assessment -->
            <div class="analysis-card">
                <h3><i class="fas fa-shield-alt"></i> Risk Assessment</h3>
                <div class="metric-display">
                    <span><i class="fas fa-exclamation-triangle"></i> Overall Risk</span>
                    <span class="risk-level" id="overallRisk">Calculating...</span>
                </div>
                <div class="metric-display">
                    <span><i class="fas fa-clipboard-check"></i> Compliance Status</span>
                    <span class="risk-level risk-low" id="complianceStatus">Checking...</span>
                </div>
                <div class="metric-display">
                    <span><i class="fas fa-flag"></i> Issues Found</span>
                    <span class="metric-value" id="issuesCount">0</span>
                </div>
            </div>

            <!-- Document Classification -->
            <div class="analysis-card">
                <h3><i class="fas fa-tags"></i> Document Classification</h3>
                <div id="documentType">
                    <p>Analyzing document type...</p>
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section" id="summarySection" style="display: none;">
            <h3><i class="fas fa-file-alt"></i> Analysis Summary</h3>
            <div id="documentSummary">
                <p>Generating executive summary...</p>
            </div>

            <div class="action-buttons">
                <button class="btn-primary" id="exportReport">
                    <i class="fas fa-download"></i> Export Report
                </button>
                <button class="btn-primary" id="askQuestions">
                    <i class="fas fa-question-circle"></i> Ask Questions
                </button>
                <button class="btn-secondary" id="compareDocuments">
                    <i class="fas fa-balance-scale"></i> Compare Documents
                </button>
            </div>
        </div>

        <!-- Document Preview (if applicable) -->
        <div id="documentPreview" style="display: none;">
            <!-- Document content would be displayed here -->
        </div>
    </main>

    <script>
        // Sample financial document data for demo
        const sampleFinancialData = {
            companyMetrics: {
                name: "TechCorp Inc.",
                period: "Q4 2024",
                revenue: "$45,200,000",
                profit: "$8,950,000",
                assets: "$120,500,000",
                liabilities: "$45,300,000",
                cashFlow: "$12,450,000",
                debtToEquity: 1.25,
                profitMargin: 19.8,
                growthRate: 12.5
            },
            quarterlyTrends: [
                { quarter: 'Q1 2024', revenue: 38500000, profit: 7450000, expenses: 31050000 },
                { quarter: 'Q2 2024', revenue: 41200000, profit: 8120000, expenses: 33080000 },
                { quarter: 'Q3 2024', revenue: 42900000, profit: 8540000, expenses: 34360000 },
                { quarter: 'Q4 2024', revenue: 45200000, profit: 8950000, expenses: 36250000 }
            ],
            expenseBreakdown: [
                { category: 'Operations', amount: 18950000, percentage: 41.9 },
                { category: 'R&D', amount: 8950000, percentage: 19.8 },
                { category: 'Marketing', amount: 5230000, percentage: 11.6 },
                { category: 'Administration', amount: 6980000, percentage: 15.4 },
                { category: 'Other', amount: 5100000, percentage: 11.3 }
            ],
            riskAnalysis: {
                overallRisk: "Low",
                complianceStatus: "Good Standing",
                redFlags: 2,
                opportunities: 5,
                industryComparison: {
                    revenueGrowth: "Above Average (+12.5%)",
                    profitMargin: "Industry Leader (19.8%)",
                    debtLevel: "Conservative (1.25 ratio)"
                }
            },
            keyInsights: [
                "Revenue growth accelerated in Q4 to 12.5%, driven by new product launches",
                "Profit margins remain strong at 19.8%, outperforming industry average by 4.2%",
                "Cash flow generation improved significantly, providing strong liquidity position",
                "R&D investment increased 15% YoY, positioning for future growth",
                "Debt-to-equity ratio of 1.25 remains conservative and well below industry norms"
            ],
            recommendations: [
                "Continue R&D investment strategy - strong ROI demonstrated",
                "Expand marketing in emerging markets to capitalize on brand strength",
                "Monitor supply chain costs amid inflationary pressures",
                "Consider share buyback program given strong cash position",
                "Accelerate international expansion to leverage competitive advantages"
            ]
        };

        // Available Hugging Face models for financial analysis
        const MODELS = {
            classification: 'facebook/bart-large-mnli',
            ner: 'dbmdz/bert-large-cased-finetuned-conll03-english',
            summarization: 'facebook/bart-large-cnn',
            qa: 'deepset/roberta-base-squad2'
        };

        // Global variables
        let uploadedFiles = [];
        let analysisResults = {};

        // DOM elements
        const uploadZone = document.getElementById('uploadZone');
        const documentInput = document.getElementById('documentInput');
        const processingStatus = document.getElementById('processingStatus');
        const errorMessage = document.getElementById('errorMessage');
        const analysisResultsDiv = document.getElementById('analysisResults');
        const summarySection = document.getElementById('summarySection');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            initializeUploadHandlers();
            hideError();

            // Auto-run sample analysis on page load after a short delay
            setTimeout(() => {
                startAnalysis();
            }, 2000);
        });

        function initializeUploadHandlers() {
            // Click to upload
            uploadZone.addEventListener('click', () => documentInput.click());

            // File selection
            documentInput.addEventListener('change', handleFileSelection);

            // Drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadZone.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadZone.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                uploadZone.classList.add('highlight');
            }

            function unhighlight(e) {
                uploadZone.classList.remove('highlight');
            }

            uploadZone.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }
        }

        function handleFileSelection(e) {
            handleFiles(e.target.files);
        }

        function handleFiles(files) {
            // Always show sample results instead of processing uploaded files
            startAnalysis();
        }

        function startAnalysis() {
            // Show processing status
            processingStatus.style.display = 'block';
            uploadZone.style.display = 'none';
            hideError();

            // Start analysis process
            updateProgress(0, 'Extracting text from documents...');
            analyzeDocuments();
        }

        async function analyzeDocuments() {
            try {
                updateProgress(25, 'Processing uploaded documents...');
                await new Promise(resolve => setTimeout(resolve, 500));

                updateProgress(50, 'Extracting financial data and metrics...');
                await new Promise(resolve => setTimeout(resolve, 500));

                updateProgress(75, 'Running AI risk assessment algorithms...');
                await new Promise(resolve => setTimeout(resolve, 500));

                updateProgress(100, 'Analysis complete! Loading dashboard...');

                // Hide processing, show results
                setTimeout(() => {
                    processingStatus.style.display = 'none';
                    displaySampleResults();
                }, 800);

            } catch (error) {
                console.error('Analysis failed:', error);
                showError('Analysis failed: ' + error.message);
                processingStatus.style.display = 'none';
                uploadZone.style.display = 'block';
            }
        }

        async function extractTextFromFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();

                reader.onload = function(e) {
                    // For demo purposes, return mock text
                    // In production, you'd use PDF.js, mammoth.js, etc.
                    const mockText = `FINANCIAL STATEMENT ANALYSIS

Company: Sample Corporation
Period: Q4 2024

Revenue: $45,200,000
Net Profit: $8,950,000
Total Assets: $120,500,000
Total Liabilities: $45,300,000

Analysis: The company shows strong financial performance with 18.3% profit margin
and solid balance sheet ratios. Key risks include market volatility and
regulatory compliance requirements in the financial services sector.

Recommendations:
1. Increase cash reserves to 15% of total assets
2. Monitor debt-to-equity ratio quarterly
3. Implement enhanced compliance monitoring systems
4. Consider expansion into emerging markets with proper risk assessment`;

                    resolve(mockText);
                };

                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        async function callHuggingFaceAPI(model, inputs, task) {
            const response = await fetch(
                `https://api-inference.huggingface.co/models/${model}`,
                {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${HUGGING_FACE_API_TOKEN}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ inputs, parameters: { max_length: 100 } })
                }
            );

            if (!response.ok) {
                if (response.status === 503) {
                    throw new Error('AI model is loading. Please try again in a few seconds.');
                }
                const errorText = await response.text();
                throw new Error(`API Error: ${response.status} - ${errorText}`);
            }

            return await response.json();
        }

        async function classifyDocument(text) {
            const inputs = `Classify this financial document: ${text.substring(0, 512)}`;
            const result = await callHuggingFaceAPI(MODELS.classification, inputs, 'classification');

            // Mock classification for demo
            return {
                label: 'Financial Statement',
                confidence: 0.92,
                categories: ['10-K Filing', 'Balance Sheet', 'Income Statement', 'Cash Flow Statement']
            };
        }

        async function extractEntities(text) {
            const inputs = `Extract financial entities: ${text.substring(0, 512)}`;
            const result = await callHuggingFaceAPI(MODELS.ner, inputs, 'ner');

            // Mock entity extraction
            return {
                companies: ['Sample Corporation', 'ABC Financial'],
                amounts: ['$45.2M', '$8.95M', '$120.5M'],
                dates: ['Q4 2024', '2024'],
                ratios: ['18.3%', '15%']
            };
        }

        async function summarizeDocument(text) {
            const inputs = `Summarize this financial document: ${text}`;
            const result = await callHuggingFaceAPI(MODELS.summarization, inputs, 'summarization');

            // Mock summary for demo
            return "Sample Corporation demonstrates strong financial performance with $45.2M revenue and $8.95M net profit. The company maintains solid balance sheet ratios and implements risk management strategies. Key recommendations include increased cash reserves and enhanced compliance monitoring.";
        }

        function extractFinancialMetrics(text) {
            // Mock financial metrics extraction
            return {
                revenue: '$45,200,000',
                profit: '$8,950,000',
                assets: '$120,500,000',
                liabilities: '$45,300,000',
                profitMargin: '18.3%',
                debtRatio: '37.5%'
            };
        }

        function updateProgress(percentage, message) {
            progressFill.style.width = percentage + '%';
            progressText.textContent = message;
        }

        function displaySampleResults() {
            analysisResultsDiv.style.display = 'grid';
            summarySection.style.display = 'block';

            // Update key metrics
            document.getElementById('revenueValue').textContent = sampleFinancialData.companyMetrics.revenue;
            document.getElementById('profitMargin').textContent = sampleFinancialData.companyMetrics.profitMargin + '%';
            document.getElementById('debtRatio').textContent = '1.25';

            // Update risk assessment
            const riskSpan = document.getElementById('overallRisk');
            riskSpan.textContent = sampleFinancialData.riskAnalysis.overallRisk + ' Risk';
            riskSpan.className = 'risk-level risk-low';

            document.getElementById('complianceStatus').textContent = sampleFinancialData.riskAnalysis.complianceStatus;
            document.getElementById('issuesCount').textContent = sampleFinancialData.riskAnalysis.redFlags;

            // Update document type
            document.getElementById('documentType').innerHTML = `
                <p><strong>TechCorp Inc.</strong> - Q4 2024 Financial Statements</p>
                <p><small>Annual Revenue Growth: ${sampleFinancialData.companyMetrics.growthRate}%</small></p>
                <p><small>Total Assets: ${sampleFinancialData.companyMetrics.assets}</small></p>
            `;

            // Update executive summary with professional Power BI-style layout
            document.getElementById('documentSummary').innerHTML = `
                <div class="executive-summary">
                    <div class="summary-header">
                        <h4><i class="fas fa-chart-line"></i> Executive Summary - TechCorp Inc. Q4 2024</h4>
                        <div class="company-metrics">
                            <div class="metric-badge">
                                <span class="metric-value">${sampleFinancialData.companyMetrics.revenue}</span>
                                <span class="metric-label">Annual Revenue</span>
                            </div>
                            <div class="metric-badge">
                                <span class="metric-value">${sampleFinancialData.companyMetrics.profitMargin}%</span>
                                <span class="metric-label">Profit Margin</span>
                            </div>
                            <div class="metric-badge">
                                <span class="metric-value ${sampleFinancialData.companyMetrics.growthRate >= 10 ? 'positive-growth' : ''}">${sampleFinancialData.companyMetrics.growthRate}%</span>
                                <span class="metric-label">YoY Growth</span>
                            </div>
                        </div>
                    </div>

                    <div class="insights-section">
                        <h5><i class="fas fa-lightbulb"></i> Key Business Insights</h5>
                        <ul class="insights-list">
                            ${sampleFinancialData.keyInsights.map(insight => `
                                <li><i class="fas fa-check-circle"></i> ${insight}</li>
                            `).join('')}
                        </ul>
                    </div>

                    <div class="quarterly-performance">
                        <h5><i class="fas fa-calendar-alt"></i> Quarterly Performance Trends</h5>
                        <div class="quarterly-charts">
                            ${sampleFinancialData.quarterlyTrends.map(quarter => `
                                <div class="quarter-card">
                                    <h6>${quarter.quarter}</h6>
                                    <div class="quarter-metrics">
                                        <div class="metric">
                                            <span class="label">Revenue:</span>
                                            <span class="value">$${(quarter.revenue / 1000000).toFixed(1)}M</span>
                                        </div>
                                        <div class="metric">
                                            <span class="label">Profit:</span>
                                            <span class="value ${quarter.profit > 8000000 ? 'positive' : ''}">$${(quarter.profit / 1000000).toFixed(1)}M</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="expense-breakdown">
                        <h5><i class="fas fa-chart-pie"></i> Expense Category Analysis</h5>
                        <div class="expense-bars">
                            ${sampleFinancialData.expenseBreakdown.map(expense => `
                                <div class="expense-item">
                                    <div class="expense-label">
                                        <span>${expense.category}</span>
                                        <span class="percentage">${expense.percentage}%</span>
                                    </div>
                                    <div class="expense-bar">
                                        <div class="expense-fill" style="width: ${expense.percentage}%"></div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="strategic-recommendations">
                        <h5><i class="fas fa-compass"></i> Strategic Recommendations</h5>
                        <div class="recommendations-grid">
                            ${sampleFinancialData.recommendations.map(rec => `
                                <div class="recommendation-card">
                                    <i class="fas fa-arrow-right"></i>
                                    <span>${rec}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="industry-comparison">
                        <h5><i class="fas fa-balance-scale"></i> Industry Benchmarking</h5>
                        <div class="industry-metrics">
                            <div class="industry-item">
                                <span class="industry-label">Revenue Growth:</span>
                                <span class="industry-value">
                                    <span class="company-value">${sampleFinancialData.riskAnalysis.industryComparison.revenueGrowth}</span>
                                    <span class="vs-industry">vs Industry Avg +8.2%</span>
                                </span>
                            </div>
                            <div class="industry-item">
                                <span class="industry-label">Profit Margin:</span>
                                <span class="industry-value">
                                    <span class="company-value">${sampleFinancialData.riskAnalysis.industryComparison.profitMargin}</span>
                                    <span class="vs-industry">vs Industry Avg 16.5%</span>
                                </span>
                            </div>
                            <div class="industry-item">
                                <span class="industry-label">Debt-to-Equity:</span>
                                <span class="industry-value">
                                    <span class="company-value">${sampleFinancialData.riskAnalysis.industryComparison.debtLevel}</span>
                                    <span class="vs-industry">Industry Avg 1.8</span>
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="financial-health">
                        <h5><i class="fas fa-shield-alt"></i> Financial Health Indicators</h5>
                        <div class="health-metrics">
                            <div class="health-item">
                                <span class="health-label">
                                    <i class="fas fa-heartbeat"></i> Cash Flow Strength:
                                </span>
                                <span class="health-value success">Strong (${sampleFinancialData.companyMetrics.cashFlow})</span>
                            </div>
                            <div class="health-item">
                                <span class="health-label">
                                    <i class="fas fa-balance-scale"></i> Balance Sheet:
                                </span>
                                <span class="health-value success">Conservative</span>
                            </div>
                            <div class="health-item">
                                <span class="health-label">
                                    <i class="fas fa-gavel"></i> Regulatory Risk:
                                </span>
                                <span class="health-value success">${sampleFinancialData.riskAnalysis.complianceStatus}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showError(message) {
            document.getElementById('errorText').textContent = message;
            errorMessage.style.display = 'block';
        }

        function hideError() {
            errorMessage.style.display = 'none';
        }

        // Export functionality (placeholder)
        document.getElementById('exportReport').addEventListener('click', () => {
            alert('Export functionality would generate a comprehensive PDF report with all analysis results.');
        });

        // Q&A functionality (placeholder)
        document.getElementById('askQuestions').addEventListener('click', () => {
            const question = prompt('Ask a question about the analyzed documents:');
            if (question) {
                alert('Q&A functionality would analyze the documents and provide specific answers to your questions.');
            }
        });

        // Document comparison (placeholder)
        document.getElementById('compareDocuments').addEventListener('click', () => {
            alert('Document comparison would allow side-by-side analysis of different financial documents.');
        });
    </script>
</body>
</html>
